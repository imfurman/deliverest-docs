# Инструкции для агента Codex

Этот проект обслуживается через Codex CLI. Ниже — набор правил и команд, которых должен придерживаться агент при работе с репозиторием.

## Подготовка окружения

- Активируй локальное виртуальное окружение: `source .venv/bin/activate` (для запуска команд достаточно указывать полный путь `.venv/bin/...`).
- Сеть и установка зависимостей запрещены. Используем только уже доступные пакеты.

## Типовой рабочий цикл

1. **Сбор информации**  
   - Просматриваем `mkdocs.yml`, нужные Markdown-файлы в `docs/`.
   - Для поиска по контенту используем `rg` (`rg "<строка>" docs`).
2. **Правки**  
   - Для единичных изменений предпочитаем `apply_patch`.  
   - При создании новых файлов соблюдаем структуру `docs/` и добавляем записи в `mkdocs.yml`, если страница должна быть в навигации.
   - Текст пишем на русском (как и остальная документация), используем Markdown строку ≤ 120 символов по возможности.
3. **Проверки**  
   - После правок обязательно запускаем `.venv/bin/mkdocs build`.  
   - Если билд падает, исправляем ошибки до чистого статуса.
4. **Отчёт пользователю**  
   - В ответе перечисляем ключевые изменения с указанием файлов и строк.
   - Сообщаем о выполненных проверках (`mkdocs build`).
   - Предлагаем дальнейшие шаги (просмотр в `mkdocs serve`, скриншоты и т.п.), если уместно.

## Ограничения и правила форматирования

- Служебный backend-проект (Symfony + Propel) хранится в поддиректории `deliverest_source/superdostavka`.
- Не редактируем файлы вне `docs/`, `mkdocs.yml`, `.github/` без явного запроса.
- В Markdown не вставляем HTML, если задача решается стандартным синтаксисом.
- Отключаем автоформатирование — используем ручное выравнивание списков/таблиц.
- Указываем внутренние ссылки в формате `../категория/страница.md`.

## Взаимодействие с CI

- Файл `.github/workflows/ci.yml` ожидает, что документация успешно собирается (`mkdocs build`).
- Дополнительных тестов нет; при необходимости фабрикуем скрипты в `scripts/` и описываем их в документации.

## Полезные команды

```bash
# Быстрая проверка одной страницы
.venv/bin/python -m mkdocs serve -a 127.0.0.1:8000 --dirtyreload --watch mkdocs.yml --watch docs

# Поиск неиспользуемых ссылок/словарей
rg "TODO" docs

# Просмотр структуры раздела
tree -L 2 docs
```

Соблюдение этих инструкций позволяет агенту работать последовательно и без неожиданностей для разработчиков.
